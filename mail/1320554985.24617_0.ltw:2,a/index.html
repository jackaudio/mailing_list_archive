<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>[Jack-Devel] Σχετ: Win7 Jack v1.9.8 - failure to register 64bit JackRouter.dll from v1.9.8</title>
<style>
pre {background: #fafafa; border: 1px solid #f1f2f3; font-size: 1.2em; padding: 10px; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word;}
h1 {font-size: 140%;}
.header_table {table-layout: fixed; width: 100%;}
.col1 {width: 120px; vertical-align: top;}
.from {font-weight: bold;}
</style>
</head>
<body>
<h1>[Jack-Devel] Σχετ: Win7 Jack v1.9.8 - failure to register 64bit JackRouter.dll from v1.9.8</h1>
<table class="header_table">
<tr><td class='col1'><a href='../1320554407.24179_0.ltw:2,a/index.html'>Prev</a></td><td><a href='../1320566719.4253_0.ltw:2,a/index.html'>Next</a>&nbsp;&nbsp;<a href='../../index.html#1320554985.24617_0.ltw:2,a'>Index</a></td></tr>
<tr><td class='col1'>Date</td><td>Sun, 06 Nov 2011 04:46:56 +0000 </td></tr>
<tr><td class='col1'>From</td><td><span class="from"> Panos Ghekas </span> &lt;[hidden] at yahoo dot gr&gt; </td></tr>
<tr><td class='col1'>To</td><td>Guy Perrin &lt;[hidden] at dobroyd dot com&gt; </td></tr>
<tr><td class='col1'>Cc</td><td>"\"[hidden] at lists dot jackaudio dot org\"" &lt;[hidden] at lists dot jackaudio dot org&gt; </td></tr>
<tr><td class='col1'>In-Reply-To</td><td>Guy Perrin
<a href='../1320550813.19159_0.ltw:2,a/index.html'>[Jack-Devel] Win7 Jack v1.9.8 - failure to register 64bit JackRouter.dll from v1.9.8 </a></td></tr>
</table>
<pre>
Hi Guy,

I'm a humble Jack user on windows a couple of years now and indeed Stephane fullfilled my wishes for a 64bit version and beyond that he&#xA0; did a mixed one !

My system is win7 home premium, 64bit, Intel T4400 dual core at 2.2GHz 4GBram, standard HDD at 5.900rpm

I really had no problem registering the 64 bit .dll with command prompt.

I have my UAC shut down. I presume you did so. It is a must on win7.

At first when I tried to register 64bit JackRouter.dll from system 32 (regsvr) I got errors too.

The solution was to run the command prompt and type&#xA0;
Regsvr32 &#x201C;C:\Program Files (x86)\Jack v1.9.8\64bits\JackRouter.dll&#x201D;

Then all went OK 
- I presume that indeed in your C:\Program Files (x86)\Jack v1.9.8 there is a folder named 64bits and inside there is the JackRouter.dll

This is a quick responce from a fellow win7 user untill Stephane or other more experienced people respond :-)

Best
Panos

PS. Glad you came and visited our jOrgan wiki ! :-D



________________________________
&#x391;&#x3C0;&#x3BF;: Guy Perrin &lt;[hidden]&gt;
&#x3A0;&#x3C1;&#x3BF;&#x3C2;: "[hidden]" &lt;[hidden]&gt;
&#x3A3;&#x3C4;&#x3AC;&#x3BB;&#x3B8;&#x3B7;&#x3BA;&#x3B5;: 5:38 &#x3C0;.&#x3BC;. &#x39A;&#x3C5;&#x3C1;&#x3B9;&#x3B1;&#x3BA;&#x3AE;, 6 &#x39D;&#x3BF;&#x3B5;&#x3BC;&#x3B2;&#x3C1;&#x3AF;&#x3BF;&#x3C5; 2011
&#x398;&#x3B5;&#x3BC;&#x3B1;: [Jack-Devel] Win7 Jack v1.9.8 - failure to register 64bit JackRouter.dll from v1.9.8


G&#x2019;day
&#xA0;
This email maybe long winded, but I figure better to give too much information rather than too little.
My intention is two-fold: to give an error report AND to request the GUID for the 64bit version of the JackRouter.dll, so I can manually create the Win7 Registry Key/Entry.
&#xA0;
The journey to (and through) the Problem:
&#xA0;
I&#x2019;ve downloaded the 64bit installation package (for v1.9.8 on Windows 7) as per instructions obtained from the Mailing List:
&#xA0;
From letz at grame.fr&#xA0; Wed Oct 12 08:02:22 2011
Subject: [Jack-Devel] Jack in Windows 7 x64
&#xA0;
Mixed 64/32 bits version: http://www.grame.fr/~letz/Jack_v1.9.8_64_setup.exe
&#xA0;
and run the installation.
The 32 bit functionality is working according to spec.
However 64bit functionality was not available.
I then found an article which presented information for Registering JackRouter for 64-bit Windows:
&#xA0;
[ http://sourceforge.net/apps/mediawiki/jorgan/index.php?title=Configuring_Jack_PortAudio_to_connect_to_your_soundcard ]
&#xA0;
Regsvr32 &#x201C;C:\Program Files (x86)\Jack v1.9.8\64bits\JackRouter.dll&#x201D;
&#xA0;
My attempt to run the registration process resulted in the display of an error MessageBox:
&#xA0;
(First dialog box)
&#xA0;
MessageBox Title: JackRouter.
Message: Register Server failed ! (-1)
&#xA0;
(click OK)
&#xA0;
(Next Message box displayed)
&#xA0;
MessageBox Title: RegSvr32
Message: The module &#x201C;C:\Program Files (x86)\Jack v1.9.8\64bits\JackRouter.dll&#x201D; was loaded but the call to DllRegisterServer failed with error code 0xffffffff.&#xA0; For more information about this problem, searchonline using the error code as a search item.
&#xA0;
I then referenced a Microsoft Knowledge Base article (http://support.microsoft.com/kb/249873 ) which contained the following non-specific information:
&#xA0;

________________________________

The module ""%1"" was loaded but the call to %2 failed with error code %3.\n\nFor more information about this problem, search online using the error code as a search term.

There was an error when regsvr32.exe invoked the entrypoint in the module specified in the command line. The error code appears as part of the message

________________________________

&#xA0;
Brickwall.
&#xA0;
I then perused the available source code for v1.9.7.
I managed to locate the GUID for the JackRouter.dll from the source code.
By referencing the Windows Registry entries under:
&#xA0;
HKEY_LOCAL_MACHINE\Software\Wow6432Node\ASIO\JackRouter (registry entry name located in the ASIO SDK from Steinberg)
&#xA0;
I was able to confirm the validity of the GUID in the source code (it was exactly the same as appeared in the Registry Key).
&#xA0;
I believe that if we have two distinct executables containing COM servers, each DLL must register a unique GUID for each.
I assume that the GUID located in the v1.9.7 code must be for 32bit, and a macro must be used in the v1.9.8 code to switch between the 32bit/64bit GUID depending on the version (32/64 bit) being compiled.
&#xA0;
Possible Solutions:
&#xA0;
1)&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; There is an issue with my Computer Setup which needs to be addressed.
I am running:
a.&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; Win7 Pro SP1 64&#xA0; bit
b.&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; HP EliteBook 8540w
c.&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; Intel Core i7 CPU Q840 @ 1.87 GHz
d.&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 16Gb RAM
I also have ASIO4ALL v2 installed and functioning.
&#xA0;
2)&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; There is an issue with v1.9.8 JackRouter.dll registration code which needs to be addressed (though I doubt it).&#xA0; No suggestions here as I don&#x2019;t have access to the source code.


3)&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; Someone sends me the GUID (or the source code) for the v1.9.8 JackRouter.dll, and I just enter it direct into the Registry Key:

HKEY_LOCAL_MACHINE\Software\ASIO\JackRouter
&#xA0;
Hope I&#x2019;m not being too presumptuous.
&#xA0;
Regardz
Guy
&#xA0;
</pre>
<table class="header_table">
<tr><td class='col1'><a href='../1320554407.24179_0.ltw:2,a/index.html'>Prev</a></td><td><a href='../1320566719.4253_0.ltw:2,a/index.html'>Next</a>&nbsp;&nbsp;<a href='../../index.html#1320554985.24617_0.ltw:2,a'>Index</a></td></tr>
</table>
<p><small>1320554985.24617_0.ltw:2,a&nbsp;&lt;1320554816.93141.YahooMailNeo at web29104 dot mail dot ird dot yahoo dot com&gt;</small></p>
<!-- Created with Bash Archive Mail -->
</body>
</html>
